<!-- webapp/templates/attacks.html -->
{% extends "base.html" %}
{% block content %}
<h2>âš¡ AdvGAN & Attack Evaluation</h2>

<!-- AdvGAN Training -->
<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h4>âš¡ AdvGAN Training</h4>
    {% if advgan_stats.error %}
      <p class="text-danger">{{ advgan_stats.error }}</p>
    {% else %}
      <div class="row text-center">
        <div class="col-md-4"><h6>Final Generator Loss</h6><p class="h4">{{ advgan_stats.gen_loss[-1] if advgan_stats.gen_loss else "N/A" }}</p></div>
        <div class="col-md-4"><h6>Final Discriminator Loss</h6><p class="h4">{{ advgan_stats.disc_loss[-1] if advgan_stats.disc_loss else "N/A" }}</p></div>
        <div class="col-md-4"><h6>Final ASR</h6><p class="h4">{{ advgan_stats.asr[-1] if advgan_stats.asr else "N/A" }}</p></div>
      </div>
      <div class="row mt-3">
        {% for plot in advgan_plots %}
          <div class="col-md-6 mb-3">
            <img src="{{ url_for('static', filename='plots/' ~ plot) }}" class="img-fluid rounded shadow">
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>

<!-- Attack Evaluation -->
<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h4>ðŸ›¡ Attack Evaluation</h4>
    {% if attack_stats.error %}
      <p class="text-danger">{{ attack_stats.error }}</p>
    {% else %}
      <div class="row text-center">
        <div class="col-md-6"><h6>Clean Accuracy</h6><p class="h4">{{ attack_stats.clean_acc if attack_stats.clean_acc else "N/A" }}</p></div>
        <div class="col-md-6"><h6>Adversarial Accuracy</h6><p class="h4">{{ attack_stats.adv_acc if attack_stats.adv_acc else "N/A" }}</p></div>
      </div>

      {% if attack_stats.per_class_asr %}
      <div class="mt-3">
        <h6>Per-class Attack Success Rate</h6>
        <pre>{{ attack_stats.per_class_asr | tojson(indent=2) }}</pre>
      </div>
      {% endif %}

      <div class="row mt-3">
        {% for plot in attack_plots %}
          <div class="col-md-6 mb-3">
            <img src="{{ url_for('static', filename='plots/' ~ plot) }}" class="img-fluid rounded shadow">
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
